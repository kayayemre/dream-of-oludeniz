class ExcelReader {
    constructor() {
        console.log('ExcelReader başlatılıyor...');
        this.setupPrices();
    }

    setupPrices() {
        // GERÇEK EXCEL VERİLERİ - STANDART ODA
        this.priceTable = {
            'Standart Oda': {
                // Temmuz 2025 - Hepsi 3995₺
                '2025-07-04': 3995, '2025-07-05': 3995, '2025-07-06': 3995, '2025-07-07': 3995,
                '2025-07-08': 3995, '2025-07-09': 3995, '2025-07-10': 3995, '2025-07-11': 3995,
                '2025-07-12': 3995, '2025-07-13': 3995, '2025-07-14': 3995, '2025-07-15': 3995,
                '2025-07-16': 3995, '2025-07-17': 3995, '2025-07-18': 3995, '2025-07-19': 3995,
                '2025-07-20': 3995, '2025-07-21': 3995, '2025-07-22': 3995, '2025-07-23': 3995,
                '2025-07-24': 3995, '2025-07-25': 3995, '2025-07-26': 3995, '2025-07-27': 3995,
                '2025-07-28': 3995, '2025-07-29': 3995, '2025-07-30': 3995, '2025-07-31': 3995,
                
                // Ağustos 2025 - Hepsi 3995₺
                '2025-08-01': 3995, '2025-08-02': 3995, '2025-08-03': 3995, '2025-08-04': 3995,
                '2025-08-05': 3995, '2025-08-06': 3995, '2025-08-07': 3995, '2025-08-08': 3995,
                '2025-08-09': 3995, '2025-08-10': 3995, '2025-08-11': 3995, '2025-08-12': 3995,
                '2025-08-13': 3995, '2025-08-14': 3995, '2025-08-15': 3995, '2025-08-16': 3995,
                '2025-08-17': 3995, '2025-08-18': 3995, '2025-08-19': 3995, '2025-08-20': 3995,
                '2025-08-21': 3995, '2025-08-22': 3995, '2025-08-23': 3995, '2025-08-24': 3995,
                '2025-08-25': 3995, '2025-08-26': 3995, '2025-08-27': 3995, '2025-08-28': 3995,
                '2025-08-29': 3995, '2025-08-30': 3995, '2025-08-31': 3995,
                
                // Eylül 2025 - Hepsi 3200₺
                '2025-09-01': 3200, '2025-09-02': 3200, '2025-09-03': 3200, '2025-09-04': 3200,
                '2025-09-05': 3200, '2025-09-06': 3200, '2025-09-07': 3200, '2025-09-08': 3200,
                '2025-09-09': 3200, '2025-09-10': 3200, '2025-09-11': 3200, '2025-09-12': 3200,
                '2025-09-13': 3200, '2025-09-14': 3200, '2025-09-15': 3200, '2025-09-16': 3200,
                '2025-09-17': 3200, '2025-09-18': 3200, '2025-09-19': 3200, '2025-09-20': 3200,
                '2025-09-21': 3200, '2025-09-22': 3200, '2025-09-23': 3200, '2025-09-24': 3200,
                '2025-09-25': 3200, '2025-09-26': 3200, '2025-09-27': 3200, '2025-09-28': 3200,
                '2025-09-29': 3200, '2025-09-30': 3200,
                
                // Ekim 2025 - Hepsi 2700₺
                '2025-10-01': 2700, '2025-10-02': 2700, '2025-10-03': 2700, '2025-10-04': 2700,
                '2025-10-05': 2700, '2025-10-06': 2700, '2025-10-07': 2700, '2025-10-08': 2700,
                '2025-10-09': 2700, '2025-10-10': 2700, '2025-10-11': 2700, '2025-10-12': 2700,
                '2025-10-13': 2700, '2025-10-14': 2700, '2025-10-15': 2700, '2025-10-16': 2700,
                '2025-10-17': 2700, '2025-10-18': 2700, '2025-10-19': 2700, '2025-10-20': 2700,
                '2025-10-21': 2700, '2025-10-22': 2700, '2025-10-23': 2700, '2025-10-24': 2700,
                '2025-10-25': 2700, '2025-10-26': 2700, '2025-10-27': 2700, '2025-10-28': 2700,
                '2025-10-29': 2700, '2025-10-30': 2700, '2025-10-31': 2700,
                
                // Kasım 2025 - Hepsi 1840₺
                '2025-11-01': 1840, '2025-11-02': 1840, '2025-11-03': 1840, '2025-11-04': 1840,
                '2025-11-05': 1840, '2025-11-06': 1840, '2025-11-07': 1840, '2025-11-08': 1840,
                '2025-11-09': 1840, '2025-11-10': 1840, '2025-11-11': 1840, '2025-11-12': 1840,
                '2025-11-13': 1840, '2025-11-14': 1840, '2025-11-15': 1840, '2025-11-16': 1840,
                '2025-11-17': 1840, '2025-11-18': 1840, '2025-11-19': 1840, '2025-11-20': 1840,
                '2025-11-21': 1840, '2025-11-22': 1840, '2025-11-23': 1840, '2025-11-24': 1840,
                '2025-11-25': 1840, '2025-11-26': 1840, '2025-11-27': 1840, '2025-11-28': 1840,
                '2025-11-29': 1840, '2025-11-30': 1840
            }
        };
        
        // Aile odası fiyatları (standart odanın %92'si)
        this.priceTable['Ara Kapılı Aile Odası'] = {};
        for (let date in this.priceTable['Standart Oda']) {
            this.priceTable['Ara Kapılı Aile Odası'][date] = Math.round(this.priceTable['Standart Oda'][date] * 0.92);
        }
    }

    getPriceForDate(date, roomType, concept = "Alkollü Herşey Dahil") {
        const dateStr = date instanceof Date ? date.toISOString().split('T')[0] : date;
        
        if (this.priceTable[roomType] && this.priceTable[roomType][dateStr]) {
            return this.priceTable[roomType][dateStr];
        }
        
        // Fallback: Default fiyat
        return roomType === 'Standart Oda' ? 3995 : 3827;
    }

    calculateTotalPriceForPeriod(checkinDate, nights, roomType, concept = "Alkollü Herşey Dahil") {
        let totalPrice = 0;
        const currentDate = new Date(checkinDate);
        
        for (let i = 0; i < nights; i++) {
            const dayPrice = this.getPriceForDate(currentDate, roomType, concept);
            totalPrice += dayPrice;
            currentDate.setDate(currentDate.getDate() + 1);
        }
        
        return totalPrice;
    }

    getStandardMultipliers() {
        return [
            {adults: 1, children: 0, childAges: [], multiplier: 1.5},
            {adults: 1, children: 1, childAges: [[0, 11.99]], multiplier: 1.5},
            {adults: 1, children: 2, childAges: [[0, 11.99], [0, 2.99]], multiplier: 1.5},
            {adults: 1, children: 2, childAges: [[0, 11.99], [3, 11.99]], multiplier: 2},
            {adults: 2, children: 0, childAges: [], multiplier: 2},
            {adults: 2, children: 1, childAges: [[0, 11.99]], multiplier: 2},
            {adults: 2, children: 2, childAges: [[0, 11.99], [0, 2.99]], multiplier: 2},
            {adults: 2, children: 2, childAges: [[0, 11.99], [3, 11.99]], multiplier: 2.75},
            {adults: 3, children: 0, childAges: [], multiplier: 2.75},
            {adults: 3, children: 1, childAges: [[0, 11.99]], multiplier: 2.75}
        ];
    }

    getFamilyMultipliers() {
        return [];
    }
}

module.exports = ExcelReader;
