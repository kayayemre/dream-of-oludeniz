class ExcelReader {
    constructor() {
        console.log('ExcelReader başlatılıyor...');
        this.setupPrices();
    }

    setupPrices() {
        // GERÇEK EXCEL VERİLERİ - STANDART ODA
        this.priceTable = {
            'Standart Oda': {
                // Temmuz 2025 - Hepsi 4160₺
                '2025-07-04': 4160, '2025-07-05': 4160, '2025-07-06': 4160, '2025-07-07': 4160,
                '2025-07-08': 4160, '2025-07-09': 4160, '2025-07-10': 4160, '2025-07-11': 4160,
                '2025-07-12': 4160, '2025-07-13': 4160, '2025-07-14': 4160, '2025-07-15': 4160,
                '2025-07-16': 4160, '2025-07-17': 4160, '2025-07-18': 4160, '2025-07-19': 4160,
                '2025-07-20': 4160, '2025-07-21': 4160, '2025-07-22': 4160, '2025-07-23': 4160,
                '2025-07-24': 4160, '2025-07-25': 4160, '2025-07-26': 4160, '2025-07-27': 4160,
                '2025-07-28': 4160, '2025-07-29': 4160, '2025-07-30': 4160, '2025-07-31': 4160,
                
                // Ağustos 2025 - Hepsi 4480₺
                '2025-08-01': 4480, '2025-08-02': 4480, '2025-08-03': 4480, '2025-08-04': 4480,
                '2025-08-05': 4480, '2025-08-06': 4480, '2025-08-07': 4480, '2025-08-08': 4480,
                '2025-08-09': 4480, '2025-08-10': 4480, '2025-08-11': 4480, '2025-08-12': 4480,
                '2025-08-13': 4480, '2025-08-14': 4480, '2025-08-15': 4480, '2025-08-16': 4480,
                '2025-08-17': 4480, '2025-08-18': 4480, '2025-08-19': 4480, '2025-08-20': 4480,
                '2025-08-21': 4480, '2025-08-22': 4480, '2025-08-23': 4480, '2025-08-24': 4480,
                '2025-08-25': 4480, '2025-08-26': 4480, '2025-08-27': 4480, '2025-08-28': 4480,
                '2025-08-29': 4480, '2025-08-30': 4480, '2025-08-31': 4480,
                
                // Eylül 2025 - Hepsi 3600₺
                '2025-09-01': 3600, '2025-09-02': 3600, '2025-09-03': 3600, '2025-09-04': 3600,
                '2025-09-05': 3600, '2025-09-06': 3600, '2025-09-07': 3600, '2025-09-08': 3600,
                '2025-09-09': 3600, '2025-09-10': 3600, '2025-09-11': 3600, '2025-09-12': 3600,
                '2025-09-13': 3600, '2025-09-14': 3600, '2025-09-15': 3600, '2025-09-16': 3600,
                '2025-09-17': 3600, '2025-09-18': 3600, '2025-09-19': 3600, '2025-09-20': 3600,
                '2025-09-21': 3600, '2025-09-22': 3600, '2025-09-23': 3600, '2025-09-24': 3600,
                '2025-09-25': 3600, '2025-09-26': 3600, '2025-09-27': 3600, '2025-09-28': 3600,
                '2025-09-29': 3600, '2025-09-30': 3600,
                
                // Ekim 2025 - Hepsi 3040₺
                '2025-10-01': 3040, '2025-10-02': 3040, '2025-10-03': 3040, '2025-10-04': 3040,
                '2025-10-05': 3040, '2025-10-06': 3040, '2025-10-07': 3040, '2025-10-08': 3040,
                '2025-10-09': 3040, '2025-10-10': 3040, '2025-10-11': 3040, '2025-10-12': 3040,
                '2025-10-13': 3040, '2025-10-14': 3040, '2025-10-15': 3040, '2025-10-16': 3040,
                '2025-10-17': 3040, '2025-10-18': 3040, '2025-10-19': 3040, '2025-10-20': 3040,
                '2025-10-21': 3040, '2025-10-22': 3040, '2025-10-23': 3040, '2025-10-24': 3040,
                '2025-10-25': 3040, '2025-10-26': 3040, '2025-10-27': 3040, '2025-10-28': 3040,
                '2025-10-29': 3040, '2025-10-30': 3040, '2025-10-31': 3040,
                
                // Kasım 2025 - Hepsi 2080₺
                '2025-11-01': 2080, '2025-11-02': 2080, '2025-11-03': 2080, '2025-11-04': 2080,
                '2025-11-05': 2080, '2025-11-06': 2080, '2025-11-07': 2080, '2025-11-08': 2080,
                '2025-11-09': 2080, '2025-11-10': 2080, '2025-11-11': 2080, '2025-11-12': 2080,
                '2025-11-13': 2080, '2025-11-14': 2080, '2025-11-15': 2080, '2025-11-16': 2080,
                '2025-11-17': 2080, '2025-11-18': 2080, '2025-11-19': 2080, '2025-11-20': 2080,
                '2025-11-21': 2080, '2025-11-22': 2080, '2025-11-23': 2080, '2025-11-24': 2080,
                '2025-11-25': 2080, '2025-11-26': 2080, '2025-11-27': 2080, '2025-11-28': 2080,
                '2025-11-29': 2080, '2025-11-30': 2080
            }
        };
        
        // Aile odası fiyatları (standart odanın %92'si)
        this.priceTable['Ara Kapılı Aile Odası'] = {};
        for (let date in this.priceTable['Standart Oda']) {
            this.priceTable['Ara Kapılı Aile Odası'][date] = Math.round(this.priceTable['Standart Oda'][date] * 0.92);
        }
    }

    getPriceForDate(date, roomType, concept = "Alkollü Herşey Dahil") {
        const dateStr = date instanceof Date ? date.toISOString().split('T')[0] : date;
        
        if (this.priceTable[roomType] && this.priceTable[roomType][dateStr]) {
            return this.priceTable[roomType][dateStr];
        }
        
        // Fallback: Default fiyat
        return roomType === 'Standart Oda' ? 4160 : 3827;
    }

    calculateTotalPriceForPeriod(checkinDate, nights, roomType, concept = "Alkollü Herşey Dahil") {
        let totalPrice = 0;
        const currentDate = new Date(checkinDate);
        
        for (let i = 0; i < nights; i++) {
            const dayPrice = this.getPriceForDate(currentDate, roomType, concept);
            totalPrice += dayPrice;
            currentDate.setDate(currentDate.getDate() + 1);
        }
        
        return totalPrice;
    }

    getStandardMultipliers() {
        return [
            {adults: 1, children: 0, childAges: [], multiplier: 1.5},
            {adults: 1, children: 1, childAges: [[0, 11.99]], multiplier: 1.5},
            {adults: 1, children: 2, childAges: [[0, 11.99], [0, 2.99]], multiplier: 1.5},
            {adults: 1, children: 2, childAges: [[0, 11.99], [3, 11.99]], multiplier: 2},
            {adults: 2, children: 0, childAges: [], multiplier: 2},
            {adults: 2, children: 1, childAges: [[0, 11.99]], multiplier: 2},
            {adults: 2, children: 2, childAges: [[0, 11.99], [0, 2.99]], multiplier: 2},
            {adults: 2, children: 2, childAges: [[0, 11.99], [3, 11.99]], multiplier: 2.75},
            {adults: 3, children: 0, childAges: [], multiplier: 2.75},
            {adults: 3, children: 1, childAges: [[0, 11.99]], multiplier: 2.75}
        ];
    }

    getFamilyMultipliers() {
        return [];
    }
}

module.exports = ExcelReader;
